# What is this:
* This is a cleaned-up version of the git: git@github.com:Spoonman376/Elastic-Reconstruction-Port.git

* Where the history is tagged onto the original authors git/work, (Ie, it's a fork now), and with some git rewriting-history and cleanup.

# Elastic reconstruction Port.
Ported/tested by:
* Erik Spooner
* Scott Saunders


## pcl_kinfu_largeScale

#misc
* Part of PCL ( with cuda / gpu / openni)

#input
* colour and depth frames.

#output
* Generates cloud\_bin\*.pcd - A PCD from every 50 frames of input.
* Generates 100-0.log - A initial log, (Inner-Segment Trajectory log (Camera or Position?)

## Global Registration

#Input:
* PCD's generated from kinfu
* 100-0.log generated by kinfu.

# Output:
* results.txt
	- a log file containing the pairwise transforms to apply to the PCDs to align them to the other PCDs.
	- will generate a transform only if it can find an alignment within a certain error bound

* pose.log
	- a log file containing the position and rotation of the camera at the time of the PCD
	- is generated based on the 100-0.log, so will have a transform at the for the the extra frames despite there not being a PCD for them, so there might be (numPCDs + 1) of them

* init.log
	- a log file containing the global position and rotation of the camera for each frame
	- is generated via the data in pose.log and the 100-0.log

* odometry.log
	- a log file containing the transforms to apply to the camera to move it from a PCD to the next.
	- is generated based on the PCDs, so there will be (numPCDs - 1) of them

* results.info
	- a log file containing a list of 6 * 6 information matrices for the transforms in results.txt
	- not very readable data

* odometry.info
	- a log file containing a list of 6 * 6 information matrices for the transforms in odometry.log
	- not very readable data


##Graph Optimizer
* Uses G2O a hyper graph optimizer library.

# Input to Graph Optimizer
* results.txt and results.info generated from GR
* odometry.log and odometry.info generated from GR
* pose.log generated from GR

# Output of Graph Optimizer
* reg\_refine\_all.log
	- a log file containing a subset of the transforms listed in results.txt
	- some these transforms have been refined slightly (seems to just be the transforms between adjacent PCDs)
* pose.log
	- a log file containing the transforms to apply to the camera to move it from a PCD to the next.
	- has been updated an refined from the pose.log generated from GR

* keep.log
	- a log file containing a subset of the transforms listed int results.txt
	- no modified values
	- honestly don’t know what this one is for yet. Doesn’t seem to be used for any of the other stages of the pipeline.


## Build Correspondence

# Input to Build Correspondence
* reg\_refine\_all.log generated from GO
* PCDs generated from Kinfu
	- currently it the way that the program is finding these is hardcoded, we will change this up to become another argument

# Output of Build Correspondence
* corres\_i\_j.txt 
	- a list of possible point correspondences between the ith and jth PCDs
	- will generate a file of correspondences for each transform listed in reg\_refine\_all.log

* reg\_output.log
	- a log file containing the pairwise transforms to apply to the PCDs to align them to the other PCDs
	- these transforms are refined versions of the transforms found in reg\_refine\_all.log

## Fragment Optimizer

# Input to Fragment Optimizer
* init.log generated from GR
* reg\_output.log generated from BC
* corres\_i\_j.txt (multiple files) generated from BC

# Output of Fragment Optimizer
* output.ctr
	- just a bunch of numbers, doesn’t seem to have much readable structure
	- used to move/adjust points to have fragments align better

* pose.log
	- a log file containing the transforms to apply to the camera to move it from a PCD to the next.
	- different/updated version than the ones generated from GR or GO

## Integrate

# Input to Integrate
* `-ref_traj <file>` - Reference trajectory to use (Every matrix is a position in global space) (Can be used without seg/pose/interval, good for testing things.)
* `-seg_traj <file>` - Usually the 100-0.log, information internal to the fragments movement
* `-pose_traj <file>` - Usually the last pose.log from the pipeline that succedded. (The pose? or traj? between fragments)
* `-interval <number>` - The number of frames in a fragment.
* `-num <number of .pcd's>`  - See below
* `-ctr <file>` - If present, output.ctr from FO; combined with num, used for processing the output of fragment optimizer. (Optional)

# Output of Integrate
* world.ply
	- a point cloud of the scene that you have scanned

